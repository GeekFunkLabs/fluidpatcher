# Plugins

[LADSPA](https://www.ladspa.org/) plugins are optional separate programs that provide additional audio effects. It is possible to compile and use them on other platforms, but at this time support is only provided for Linux usage.

## Installation

To install a base LADSPA system and several batches of plugins, enter

```bash
sudo apt-get install ladspa-sdk swh-plugins tap-plugins wah-plugins
```

To compile and install `patchcord.so`, which is used for mixing channels to outputs, go to the `src/` folder and enter

```bash
sudo gcc -shared patchcord.c -o /usr/lib/ladspa/patchcord.so
```

## Setup

To enable plugins, set the fluidsetting `synth.ladspa.active: 1` in the config file, and set `plugindir` to the location where plugins are stored (most Linux distributions put them in `/usr/lib/ladspa` by default). The fluidsetting `synth.audio-groups` can be used to create separate effects mixing channels. The audio generated by each MIDI channel is assigned to an audio group in order, wrapping around if there are fewer groups than MIDI channels.

```yaml
bankdir: config/banks
plugindir: /usr/lib/ladspa
fluidsettings:
  midi.autoconnect: 1
  player.reset-synth: 0
  synth.audio.groups: 16
  synth.ladspa.active: 1
currentbank: bank1.yaml
```

## Usage

To add plugins to a bank file, create a `ladspafx` section as described in [Creating Banks](bank_files.md#ladspafx). The LADSPA SDK provides the `analyseplugin` command in order to view information about what audio in/out ports and control ports a plugin has. Enter the command, followed by the full path of the plugin. Here is the output for the `amp` plugin:

```bash
$ analyseplugin /usr/lib/ladspa/amp.so

Plugin Name: "Mono Amplifier"
Plugin Label: "amp_mono"
Plugin Unique ID: 1048
Maker: "Richard Furse (LADSPA example plugins)"
Copyright: "None"
Must Run Real-Time: No
Has activate() Function: No
Has deactivate() Function: No
Has run_adding() Function: No
Environment: Normal or Hard Real-Time
Ports:  "Gain" input, control, 0 to ..., default 1, logarithmic
        "Input" input, audio
        "Output" output, audio

Plugin Name: "Stereo Amplifier"
Plugin Label: "amp_stereo"
Plugin Unique ID: 1049
Maker: "Richard Furse (LADSPA example plugins)"
Copyright: "None"
Must Run Real-Time: No
Has activate() Function: No
Has deactivate() Function: No
Has run_adding() Function: No
Environment: Normal or Hard Real-Time
Ports:  "Gain" input, control, 0 to ..., default 1, logarithmic
        "Input (Left)" input, audio
        "Output (Left)" output, audio
        "Input (Right)" input, audio
        "Output (Right)" output, audio
```
